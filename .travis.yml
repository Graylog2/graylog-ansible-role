---
branches:
  only:
    - "master"

dist: bionic

language: python
python: 3.8

# Cache the big Vagrant boxes
cache:
  directories:
  - /home/travis/.vagrant.d/boxes

install:
# Install libvrt & KVM (see https://github.com/alvistack/ansible-role-virtualbox/blob/master/.travis.yml)
- sudo apt-get update && sudo apt-get install -y bridge-utils dnsmasq-base ebtables libvirt-bin libvirt-dev qemu-kvm qemu-utils ruby-dev
- sudo wget -nv https://releases.hashicorp.com/vagrant/2.2.10/vagrant_2.2.10_x86_64.deb
- sudo dpkg -i vagrant_2.2.10_x86_64.deb
- vagrant --version
- sudo vagrant plugin install vagrant-libvirt
- pip3 install molecule yamllint ansible-lint python-vagrant molecule-vagrant testinfra
- sudo chown -R travis:travis /home/travis/.vagrant.d

script:
#- sudo vagrant up --provider=libvirt
#- sudo vagrant ssh -c "echo 'hello world!'"
- sudo -E su travis travis.sh
